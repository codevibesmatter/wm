# Unified kata configuration for kata-wm project
# Replaces wm.yaml + modes.yaml (see issue #30)

project:
  name: kata-wm
  test_command: node --test dist/testing/index.js 2>/dev/null || true

spec_path: planning/specs
research_path: planning/research
session_retention_days: 7

reviews:
  code_review: false
  code_reviewer: null

modes:
  # --- Core Modes ---

  research:
    name: "Research"
    description: "Explore → synthesize findings"
    stop_conditions:
      - tasks_complete
      - committed
    intent_keywords:
      - "research"
      - "explore"
      - "learn about"
    template: "research.md"

  planning:
    name: "Planning"
    description: "Research → spec → review → approved"
    issue_handling: "required"
    issue_label: "feature"
    stop_conditions:
      - tasks_complete
      - committed
    intent_keywords:
      - "plan feature"
      - "spec"
      - "design"
      - "write spec"
    template: "planning.md"

  implementation:
    name: "Implementation"
    description: "Execute approved specs - phases defined in spec YAML frontmatter"
    issue_handling: "required"
    issue_label: "feature"
    stop_conditions:
      - tasks_complete
      - committed
      - pushed
      - tests_pass
      - feature_tests_added
    intent_keywords:
      - "implement"
      - "build"
      - "code"
      - "develop"
      - "execute spec"
    template: "implementation.md"

  task:
    name: "Task"
    description: "Combined planning + implementation for small tasks and chores"
    issue_handling: "none"
    stop_conditions:
      - tasks_complete
      - committed
    intent_keywords:
      - "task:"
      - "chore"
      - "small task"
      - "quick change"
      - "cleanup"
      - "refactor"
    template: "task.md"
    workflow_prefix: "TK"
    aliases:
      - "chore"
      - "small"

  freeform:
    name: "Freeform"
    description: "Quick questions and discussion (no phases)"
    stop_conditions: []
    intent_keywords:
      - "question"
      - "how does"
      - "what is"
      - "where is"
      - "explain"
      - "help me understand"
    template: "freeform.md"
    workflow_prefix: "FF"
    aliases:
      - "question"
      - "ask"
      - "help"
      - "qa"

  verify:
    name: "Verify"
    description: "Execute Verification Plan steps against real running system"
    issue_handling: "none"
    stop_conditions:
      - tasks_complete
      - committed
      - pushed
    intent_keywords:
      - "verify"
      - "run verification"
      - "execute VP"
      - "verification plan"
    template: "verify.md"
    workflow_prefix: "VF"

  stop-hook-test:
    name: "Stop Hook Test"
    description: "Eval-only mode that exercises each stop condition in sequence"
    stop_conditions:
      - tasks_complete
      - committed
      - pushed
    template: "stop-hook-test.md"
    workflow_prefix: "SH"

  onboard:
    name: "Onboard"
    description: "Configure kata for a new project via guided interview"
    stop_conditions: []
    intent_keywords:
      - "onboard"
      - "setup kata"
      - "configure kata"
      - "initialize kata"
    template: "onboard.md"

  # --- Project-specific modes ---

  eval:
    name: "Eval"
    description: "Run agentic eval scenarios — drive inner agents, verify results"
    stop_conditions: []
    intent_keywords:
      - "eval"
      - "run eval"
      - "test scenario"
    template: "eval.md"
    workflow_prefix: "EV"

  # --- Deprecated Redirects ---

  strategic:
    name: "Strategic Planning (DEPRECATED)"
    description: "(DEPRECATED) Use planning mode instead"
    deprecated: true
    redirect_to: "planning"
    template: "planning.md"

  doctrine:
    name: "Doctrine (DEPRECATED)"
    description: "(DEPRECATED) Use planning mode instead"
    deprecated: true
    redirect_to: "planning"
    template: "planning.md"

  feature-clarification:
    name: "Feature Clarification (DEPRECATED)"
    description: "(DEPRECATED) Use planning mode instead"
    deprecated: true
    redirect_to: "planning"
    template: "feature-clarification.md"

  micro-planning:
    name: "Micro-Planning (DEPRECATED)"
    description: "(DEPRECATED) Use planning mode instead"
    deprecated: true
    redirect_to: "planning"
    template: "planning.md"

  bugfix:
    name: "Bug Fix (DEPRECATED)"
    description: "(DEPRECATED) Use implementation mode instead"
    deprecated: true
    redirect_to: "implementation"
    template: "implementation.md"

  hotfix:
    name: "Hotfix (DEPRECATED)"
    description: "(DEPRECATED) Use implementation mode instead"
    deprecated: true
    redirect_to: "implementation"
    template: "implementation-hotfix.md"

  debug:
    name: "Debug (DEPRECATED)"
    description: "(DEPRECATED) Use research mode instead"
    deprecated: true
    redirect_to: "research"
    template: "debug.md"

  management:
    name: "Management (DEPRECATED)"
    description: "(DEPRECATED) Use freeform mode instead"
    deprecated: true
    redirect_to: "freeform"
    template: "freeform.md"

  orchestrator:
    name: "Orchestrator (DEPRECATED)"
    description: "(DEPRECATED) Use task mode instead"
    deprecated: true
    redirect_to: "task"
    template: "task.md"

  dedicated-testing:
    name: "Dedicated Testing (DEPRECATED)"
    description: "(DEPRECATED) Use task mode instead"
    deprecated: true
    redirect_to: "task"
    template: "implementation-testing.md"

  calibration:
    name: "Calibration (DEPRECATED)"
    description: "(DEPRECATED) Use freeform mode instead"
    deprecated: true
    redirect_to: "freeform"
    template: "freeform.md"

  session-discovery:
    name: "Session Discovery (DEPRECATED)"
    description: "(DEPRECATED) Use research mode instead"
    deprecated: true
    redirect_to: "research"
    template: "research.md"

  flow:
    name: "Flow State (DEPRECATED)"
    description: "(DEPRECATED) Use freeform mode instead"
    deprecated: true
    redirect_to: "freeform"
    template: "freeform.md"
    aliases:
      - "flow-state"
