# kata.yaml — unified project configuration
# Generated by: kata batteries
# Docs: https://github.com/codevibesmatter/kata-wm

project:
  name: ""
  # test_command: "npm test"
  # build_command: "npm run build"

spec_path: planning/specs
research_path: planning/research
session_retention_days: 7

# reviews:
#   code_review: false
#   code_reviewer: null

# Global rules — injected into every mode's context
# global_rules:
#   - "Your project-wide rule here"

# Task system rules — injected when mode has phases (tasks)
# Override to customize; remove to disable
task_rules:
  - "Tasks are pre-created by kata enter. Do NOT create new tasks with TaskCreate."
  - "Run TaskList FIRST to discover pre-created tasks and their dependency chains."
  - "Use TaskUpdate to mark tasks in_progress/completed. Never use TaskCreate."
  - "Follow the dependency chain — blocked tasks cannot start until dependencies complete."

modes:
  research:
    name: "Research"
    description: "Explore and synthesize findings"
    stop_conditions:
      - tasks_complete
      - committed
    intent_keywords:
      - "research"
      - "explore"
      - "learn about"
    template: "research.md"

  planning:
    name: "Planning"
    description: "Research, spec, review, approved"
    issue_handling: "required"
    issue_label: "feature"
    stop_conditions:
      - tasks_complete
      - committed
    intent_keywords:
      - "plan feature"
      - "spec"
      - "design"
      - "write spec"
    template: "planning.md"

  implementation:
    name: "Implementation"
    description: "Execute approved specs"
    issue_handling: "required"
    issue_label: "feature"
    stop_conditions:
      - tasks_complete
      - committed
      - pushed
      - verification
      - tests_pass
      - feature_tests_added
    intent_keywords:
      - "implement"
      - "build"
      - "code"
      - "develop"
      - "execute spec"
    template: "implementation.md"

  task:
    name: "Task"
    description: "Combined planning + implementation for small tasks"
    issue_handling: "none"
    stop_conditions:
      - tasks_complete
      - committed
    intent_keywords:
      - "task:"
      - "chore"
      - "small task"
      - "quick change"
      - "cleanup"
      - "refactor"
    template: "task.md"
    workflow_prefix: "TK"
    aliases:
      - "chore"
      - "small"

  freeform:
    name: "Freeform"
    description: "Quick questions and discussion (no phases)"
    stop_conditions: []
    intent_keywords:
      - "question"
      - "how does"
      - "what is"
      - "where is"
      - "explain"
      - "help me understand"
    template: "freeform.md"
    workflow_prefix: "FF"
    aliases:
      - "question"
      - "ask"
      - "help"
      - "qa"

  verify:
    name: "Verify"
    description: "Execute Verification Plan steps"
    issue_handling: "none"
    stop_conditions:
      - tasks_complete
      - verification_plan_executed
    intent_keywords:
      - "verify"
      - "run verification"
      - "execute VP"
      - "verification plan"
    template: "verify.md"
    workflow_prefix: "VF"

  onboard:
    name: "Onboard"
    description: "Configure kata for a new project"
    stop_conditions: []
    intent_keywords:
      - "onboard"
      - "setup kata"
      - "configure kata"
      - "initialize kata"
    template: "onboard.md"

  # --- Deprecated Redirects ---

  strategic:
    deprecated: true
    redirect_to: "planning"
    template: "planning.md"

  doctrine:
    deprecated: true
    redirect_to: "planning"
    template: "planning.md"

  feature-clarification:
    deprecated: true
    redirect_to: "planning"
    template: "feature-clarification.md"

  micro-planning:
    deprecated: true
    redirect_to: "planning"
    template: "planning.md"

  bugfix:
    deprecated: true
    redirect_to: "implementation"
    template: "implementation.md"

  hotfix:
    deprecated: true
    redirect_to: "implementation"
    template: "implementation-hotfix.md"

  debug:
    deprecated: true
    redirect_to: "research"
    template: "debug.md"

  management:
    deprecated: true
    redirect_to: "freeform"
    template: "freeform.md"

  orchestrator:
    deprecated: true
    redirect_to: "task"
    template: "task.md"

  dedicated-testing:
    deprecated: true
    redirect_to: "task"
    template: "implementation-testing.md"

  calibration:
    deprecated: true
    redirect_to: "freeform"
    template: "freeform.md"

  session-discovery:
    deprecated: true
    redirect_to: "research"
    template: "research.md"

  flow:
    deprecated: true
    redirect_to: "freeform"
    template: "freeform.md"
    aliases:
      - "flow-state"
